# Описание OpenAPI

## **Device Management Service**

### **1. Получение информации об устройстве**

- **Эндпойнт**: `/devices/{device_id}`
- **Метод**: `GET`
- **Описание**: Получение информации об устройстве по его ID.
- **Параметры:**
    - `device_id` (путь) — Идентификатор устройства (UUID).
- **Формат ответа:**
    - `id` (String) — Идентификатор устройства.
    - `type_id` (String) — Идентификатор типа устройства.
    - `house_id` (String) — Идентификатор дома, к которому относится устройство.
    - `serial_number` (String) — Серийный номер устройства.
    - `status` (String) — Текущее состояние устройства.
- **Коды ответа:**
    - `200` — Информация об устройстве возвращена.
    - `404` — Устройство не найдено.
    - `500` — Ошибка сервера.

### **2. Обновление состояния устройства**

- **Эндпойнт**: `/devices/{device_id}/status`
- **Метод**: `PUT`
- **Описание**: Обновление состояния устройства.
- **Параметры:**
    - `device_id` (путь) — Идентификатор устройства (UUID).
- **Тело запроса:**
    - `status` (String) — Новое состояние устройства.
- **Формат ответа:**
    - `message` (String) — Сообщение о результате операции.
- **Коды ответа:**
    - `200` — Состояние устройства обновлено.
    - `400` — Некорректный запрос.
    - `404` — Устройство не найдено.
    - `500` — Ошибка сервера.

### **3. Отправка команды устройству**

- **Эндпойнт**: `/devices/{device_id}/commands`
- **Метод**: `POST`
- **Описание**: Отправка команды устройству.
- **Параметры:**
    - `device_id` (путь) — Идентификатор устройства (UUID).
- **Тело запроса:**
    - `command` (String) — Команда для выполнения устройством.
- **Формат ответа:**
    - `message` (String) — Сообщение о результате операции.
- **Коды ответа:**
    - `200` — Команда отправлена.
    - `400` — Некорректный запрос.
    - `404` — Устройство не найдено.
    - `500` — Ошибка сервера.

## **User Management Service**

### **1. Получение списка всех пользователей**

- **Эндпойнт**: `/users`
- **Метод**: `GET`
- **Описание**: Получение списка всех пользователей.
- **Формат ответа:**
    - `id` (String) — Идентификатор пользователя.
    - `name` (String) — Имя пользователя.
    - `email` (String) — Электронная почта пользователя.
    - `created_at` (String) — Дата и время создания пользователя.
- **Коды ответа:**
    - `200` — Список пользователей возвращен.
    - `500` — Ошибка сервера.

### **2. Создание нового пользователя**

- **Эндпойнт**: `/users`
- **Метод**: `POST`
- **Описание**: Создание нового пользователя.
- **Тело запроса:**
    - `name` (String) — Имя пользователя.
    - `email` (String) — Электронная почта пользователя.
    - `password` (String) — Пароль пользователя.
- **Формат ответа:**
    - `id` (String) — Идентификатор созданного пользователя.
    - `message` (String) — Сообщение о результате операции.
- **Коды ответа:**
    - `201` — Пользователь создан.
    - `400` — Некорректный запрос.
    - `500` — Ошибка сервера.

### **3. Получение информации о пользователе**

- **Эндпойнт**: `/users/{user_id}`
- **Метод**: `GET`
- **Описание**: Получение информации о пользователе по его ID.
- **Параметры:**
    - `user_id` (путь) — Идентификатор пользователя (UUID).
- **Формат ответа:**
    - `id` (String) — Идентификатор пользователя.
    - `name` (String) — Имя пользователя.
    - `email` (String) — Электронная почта пользователя.
    - `created_at` (String) — Дата и время создания пользователя.
- **Коды ответа:**
    - `200` — Информация о пользователе возвращена.
    - `404` — Пользователь не найден.
    - `500` — Ошибка сервера.

### **4. Обновление информации о пользователе**

- **Эндпойнт**: `/users/{user_id}`
- **Метод**: `PUT`
- **Описание**: Обновление информации о пользователе.
- **Параметры:**
    - `user_id` (путь) — Идентификатор пользователя (UUID).
- **Тело запроса:**
    - `name` (String) — Имя пользователя.
    - `email` (String) — Электронная почта пользователя.
    - `password` (String, optional) — Новый пароль пользователя (если требуется).
- **Формат ответа:**
    - `message` (String) — Сообщение о результате операции.
- **Коды ответа:**
    - `200` — Информация о пользователе обновлена.
    - `400` — Некорректный запрос.
    - `404` — Пользователь не найден.
    - `500` — Ошибка сервера.

### **5. Удаление пользователя**

- **Эндпойнт**: `/users/{user_id}`
- **Метод**: `DELETE`
- **Описание**: Удаление пользователя из системы.
- **Параметры:**
    - `user_id` (путь) — Идентификатор пользователя (UUID).
- **Формат ответа:**
    - `message` (String) — Сообщение о результате операции.
- **Коды ответа:**
    - `200` — Пользователь удален.
    - `404` — Пользователь не найден.
    - `500` — Ошибка сервера.

---
# Описание AsyncAPI

#### **AsyncAPI Version**
Указывает версию спецификации AsyncAPI, используемую для описания API.

#### **Info**
Основная информация о API, включая:
- **Title**: Название API.
- **Version**: Версия API.
- **Description**: Описание API, включая детали о его назначении и функциональности.

#### **Servers**
Определяет серверы, на которых будет работать API. В примере используется Kafka-брокер:
- **URL**: `kafka-broker:9092`
- **Protocol**: Kafka

#### **Channels**
Определяет каналы для публикации и подписки на события. В примере используется канал `deviceStateChange`:
- **deviceStateChange**:
  - **Description**: Канал для публикации и подписки на изменения состояния устройств.

  - **subscribe**:
    Определяет операцию подписки на события изменения состояния устройств.
    - **Summary**: Подписка на события изменения состояния устройств.
    - **OperationId**: `onDeviceStateChange`
    - **Message**: Описание сообщения, которое будет получено при подписке.

  - **publish**:
    Определяет операцию публикации событий изменения состояния устройств.
    - **Summary**: Публикация события изменения состояния устройства.
    - **OperationId**: `publishDeviceStateChange`
    - **Message**: Описание сообщения, которое будет опубликовано.

#### **Components**
Определяет различные компоненты, используемые в спецификации.

- **Messages**
  Определяет формат сообщений для канала:
  - **DeviceStateChangeMessage**: Сообщение, описывающее событие изменения состояния устройства.
    - **ContentType**: `application/json`
    - **Payload**: Схема данных сообщения.

- **Schemas**
  Определяет схему данных для сообщений:
  - **DeviceStateChangePayload**:
    - **Type**: Object
    - **Properties**:
      - **device_id**: Идентификатор устройства.
      - **new_state**: Новое состояние устройства.
      - **timestamp**: Время изменения состояния.
